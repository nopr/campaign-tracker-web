<div class="col-md-12">

  <section ng-if="!faction">

    <div class="page-header">
      <h1>Factions</h1>
    </div>

    <div class="row">
      <div style="width: 30%; float: left;" ng-repeat="faction in factions">
        <div class="panel panel-default">
          <div class="panel-heading">
            <a href="#/factions/{{ faction._id }}" class="image">
              <img style="max-width: 100%;" src="//placehold.it/200x200" />
            </a>
          </div>
          <div class="panel-body">
            <h4><a href="#/factions/{{ faction._id }}" class="header">{{ faction.name }}</a></h4>
            <b>Commander:</b> {{ faction.commander.name }}
          </div>
          <div class="panel-footer">
            {{ faction.players.length }} Members
          </div>
        </div>
      </div>
    </div>

    <h4 class="ui dividing header">Create new faction</h4>
    <form class="ui form" ng-submit="addFaction()">
      <div class="two fields">
        <div class="field">
          <label>Name</label>
          <input type="text" ng-model="data.name" name="name" placeholder="Black Sun Syndicate" />
        </div>
        <div class="field">
          <label>Commander</label>
          <select ng-model="data.commander" class="ui selection dropdown">
            <option ng-repeat="player in players" value="{{ player._id }}">{{ player.name }}</option>
          </select>
        </div>
      </div>
      <div class="field">
        <button type="submit" class="ui fluid positive button">Create</button>
      </div>
    </form>

  </section>

  <form name="EditFaction" class="ui form" ng-if="faction" ng-submit="editFaction()">

    <div class="page-header">
      <h2>{{ faction.name }}</h2>
    </div>

    <h4 class="ui dividing header">Faction Information</h4>
    <div class="two fields">
      <div class="field">
        <label>Name</label>
        <input type="text" ng-model="faction.name" name="name" />
      </div>
      <div class="field">
        <label>Commander</label>
        <select ng-model="faction.commander" class="ui selection dropdown">
          <option ng-repeat="player in faction.players" ng-selected="player._id === faction.commander._id" value="{{ player._id }}">{{ player.name }}</option>
        </select>
      </div>
    </div>
    <div class="field" ng-show="EditFaction.$dirty">
      <button ng-disabled="EditFaction.$submitted" type="submit" class="ui positive button">Save</button>
    </div>

    <h4 class="ui dividing header">Faction Members</h4>
    <table class="ui celled striped table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Win</th>
          <th>Draw</th>
          <th>Lose</th>
          <th>MOV</th>
          <th>Score</th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="player in faction.players">
          <td>{{ player.name }}</td>
          <td>{{ player.games.won }}</td>
          <td>{{ player.games.drawn }}</td>
          <td>{{ player.games.lost }}</td>
          <td>{{ player.score.average }}</td>
          <td>{{ player.score.cumulative }}</td>
        </tr>
        <tr ng-if="!players.length">
          <td colspan="7">No players</td>
        </tr>
      </tbody>
    </table>

    <h2 class="ui center aligned icon header">
      <button class="ui negative button" ng-click="removeFaction(faction._id)">Remove Faction</button>
    </h2>

  </form>

</div>
